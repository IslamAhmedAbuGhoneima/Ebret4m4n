<section class="bg-[#F9FAFB] min-h-screen font-arabic">
  <div class="container pt-6 pb-7">
    <h3 class="text-[28px] font-semibold text-[#51419]">ุชุนุฏูู ุจูุงูุงุช ุงูุทูู</h3>

    <div class="max-w-[520px] mx-auto mt-6">
      <div class="flex justify-center items-center">
        <img src="/images/edit profile.svg" />
      </div>
      <div class="mt-4">
        <form [formGroup]="formEditProfile" (ngSubmit)="saveNewData()">
          <div class="mb-4">
            <label
              class="block text-xl font-semibold mb-2 mr-2"
              for="childName"
            >
              ุงูุฅุณู</label
            >
            <input
              formControlName="childName"
              [ngClass]="{
                'border-red-700': childName?.invalid && childName?.dirty,
                'border-third-border': childName?.valid || childName?.untouched
              }"
              class="block w-full placeholder:text-base placeholder:font-arabic placeholder:text-third-txt text-right px-4 py-3 outline-none rounded-lg border-[1.5px] border-third-border"
              type="text"
              name="childName"
              id="childName"
              placeholder=" ุฅุณู ุงูุทูู"
            />

            <div
              class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
              *ngIf="childName?.invalid && childName?.dirty"
            >
              <img
                src="./icons/si_warning-fill.svg"
                alt=""
                class="w-4 h-4 mt-[1px]"
              />
              <div>
                <small *ngIf="childName?.errors?.['required']">
                  ูุฌุจ ุฅุฏุฎุงู ุฅุณู ุงูุทูู.
                </small>
                <small *ngIf="childName?.errors?.['pattern']">
                  ูุฌุจ ุฅุฏุฎุงู ุงูุฅุณู ุจุงููุบุฉ ุงูุนุฑุจูุฉ ููุท.
                </small>
                <small
                  *ngIf="!childName?.errors?.['pattern']  && childName?.errors?.['minlength']"
                  >ูุฌุจ ุฃู ูููู ุทูู ุงูุฅุณู ูุง ููู ุนู 3 ุญุฑูู.
                </small>
              </div>
            </div>
          </div>
          <div class="mb-4">
            <label class="block text-xl font-semibold mb-2 mr-2" for="NID">
              ุงูุฑูู ุงููููู</label
            >
            <div class="relative">
              <input
                formControlName="NID"
                [ngClass]="{
                  'border-red-700': id?.invalid && id?.dirty,
                  'border-third-border': id?.valid || id?.untouched
                }"
                type="number"
                name="NID"
                id="NID"
                placeholder="1234 5678 9123 45"
                class="placeholder:text-right w-full py-3 px-10 border rounded-lg outline-none border-third-border placeholder:text-third-txt placeholder:text-base"
              />
              <img
                class="absolute right-4 top-1/2 -translate-y-[calc(50%+1px)] text-sm w-[18px] h-[18px]"
                src="icons/teenyicons_id-outline.svg"
                alt=""
              />
            </div>
            <div
              class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
              *ngIf="id?.invalid && id?.dirty"
            >
              <img
                src="./icons/si_warning-fill.svg"
                alt=""
                class="w-4 h-4 mt-[1px]"
              />
              <div>
                <small *ngIf="id?.errors?.['required']">
                  ูุฌุจ ุฅุฏุฎุงู ุงูุฑูู ุงููููู ููุทูู.
                </small>
                <small *ngIf="id?.errors?.['pattern']">
                  ูุฌุจ ุฃู ูููู ุงูุฑูู ุงููููู ููุทูู ูููู ูู 14 ุฎุงูุฉ.
                </small>
              </div>
            </div>
          </div>
          <!-- birthday -->
          <div class="mb-5" formGroupName="birthday">
            <label class="block text-xl font-semibold mb-2 mr-2" for="day">
              ุชุงุฑูุฎ ุงููููุงุฏ</label
            >
            <div class="flex gap-4">
              <div class="flex-1">
                <input
                  formControlName="day"
                  [ngClass]="{
                    'border-red-700': day?.invalid && day?.dirty,
                    'border-third-border': day?.valid || day?.untouched
                  }"
                  class="block w-full placeholder:text-base placeholder:text-third-txt text-right px-4 py-3 outline-none rounded-lg border-[1.5px] border-third-border"
                  type="number"
                  name="day"
                  id="day"
                  placeholder="ุงูููู"
                  (input)="onDayInput($event)"
                />

                <div
                  class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
                  *ngIf="day?.invalid && day?.dirty"
                >
                  <img
                    src="./icons/si_warning-fill.svg"
                    alt=""
                    class="w-4 h-4 mt-[1px]"
                  />
                  <div>
                    <small *ngIf="day?.errors?.['required']">
                      ุฅุฏุฎู ููู ูููุงุฏ ุงูุทูู.
                    </small>
                  </div>
                </div>
              </div>
              <div class="mb-4 flex-1 font-arabic">
                <div class="relative">
                  <select
                    formControlName="month"
                    [ngClass]="{
                      'border-red-700':
                        gender?.invalid && (month?.touched || month?.dirty),
                      'border-third-border': month?.valid || month?.untouched
                    }"
                    class="w-full text-[#151419] px-4 py-3 rounded-md border border-third-border appearance-none text-right outline-none cursor-pointer"
                    name="months"
                    id="months"
                  >
                    <option value="" disabled selected>ุงูุดูุฑ</option>
                    @for (item of months; track $index) {
                    <option [value]="$index + 1">{{ item }}</option>
                    }
                  </select>

                  <img
                    class="block absolute top-1/2 -translate-y-[calc(50%+1.5px)] left-6 cursor-pointer"
                    src="icons/Caret Down.svg"
                    alt=""
                  />
                </div>
                <div
                  class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
                  *ngIf="month?.invalid && (month?.touched || month?.dirty)"
                >
                  <img
                    src="./icons/si_warning-fill.svg"
                    alt=""
                    class="w-4 h-4 mt-[1px]"
                  />
                  <div>
                    <small *ngIf="month?.errors?.['required']">
                      ูุฐู ุงูุฎุงูู ูุทููุจุฉ.
                    </small>
                  </div>
                </div>
              </div>
              <div class="flex-1">
                <input
                  formControlName="year"
                  [ngClass]="{
                    'border-red-700': year?.invalid && year?.dirty,
                    'border-third-border': year?.valid || year?.untouched
                  }"
                  class="block w-full placeholder:text-base placeholder:text-third-txt text-right px-4 py-3 outline-none rounded-lg border border-third-border"
                  type="number"
                  name="year"
                  id="year"
                  placeholder="ุนุงู "
                  (input)="onDayInput($event)"
                />

                <div
                  class="text-red-700 font-semibold font-arabic font-base flex items-center gap-x-1"
                  *ngIf="year?.invalid && year?.dirty"
                >
                  <img
                    src="./icons/si_warning-fill.svg"
                    alt=""
                    class="w-4 h-4 mt-[1px]"
                  />
                  <div>
                    <small *ngIf="year?.errors?.['required']">
                      ุฅุฏุฎู ุณูู ูููุงุฏ ุงูุทูู.
                    </small>
                    <small
                      *ngIf="year?.errors?.['min'] || year?.errors?.['pattern']"
                    >
                      ุฅุฏุฎู ุณูู ุตุญูุญู.
                    </small>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="text-red-700 -mt-2 ml-2 font-semibold font-arabic text-sm flex items-center gap-1"
              *ngIf="(birthday.dirty || birthday.touched) && 
         (birthday.errors?.['futureDate'] || 
          birthday.errors?.['invalidDate'] || 
          birthday.errors?.['invalidMonth'])"
            >
              <img
                src="./icons/si_warning-fill.svg"
                alt=""
                class="w-4 h-4 mt-[1px]"
              />
              <small>ุงุฏุฎู ุชุงุฑูุฎ ูููุงุฏ ุตุญูุญ.</small>
            </div>
          </div>
          <!-- gender -->
          <div class="mb-4 flex-1 font-arabic">
            <div class="relative">
              <select
                formControlName="gender"
                [ngClass]="{
                  'border-red-700':
                    gender?.invalid && (gender?.touched || gender?.dirty),
                  'border-third-border': gender?.valid || gender?.untouched
                }"
                class="w-full text-[#151419] px-3 py-4 rounded-md border border-third-border appearance-none text-right outline-none cursor-pointer"
                name="gender"
                id="gender"
              >
                <option value="" disabled>ุงูููุน</option>
                <option value="m">ุฐูุฑ</option>
                <option value="f">ุงูุซู</option>
              </select>
              <img
                class="block absolute top-1/2 -translate-y-[calc(50%+1.5px)] left-6 cursor-pointer"
                src="icons/Caret Down.svg"
                alt=""
              />
            </div>
            <div
              class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
              *ngIf="gender?.invalid && (gender?.touched || gender?.dirty)"
            >
              <img
                src="./icons/si_warning-fill.svg"
                alt=""
                class="w-4 h-4 mt-[1px]"
              />
              <div>
                <small *ngIf="gender?.errors?.['required']">
                  ูุฌุจ ุฅุฎุชูุงุฑ ุฌูุณ ุงูุทูู.
                </small>
              </div>
            </div>
          </div>
          <div class="mb-4">
            <label class="block text-xl font-semibold mb-2 mr-2" for="weight">
              ุงููุฒู</label
            >
            <div class="relative">
              <input
                formControlName="weight"
                [ngClass]="{
                  'border-red-700': weight?.invalid && weight?.dirty,
                  'border-third-border': weight?.valid || weight?.untouched
                }"
                type="number"
                name="weight"
                id="weight"
                placeholder="ูููู ุฌุฑุงู"
                class="placeholder:text-right w-full py-3 px-10 border rounded-lg outline-none border-third-border placeholder:text-third-txt placeholder:text-base"
              />
              <img
                class="absolute right-4 top-1/2 -translate-y-[calc(50%+1px)] text-sm w-[18px] h-[18px]"
                src="icons/weight.svg"
                alt=""
              />
            </div>
            <div
              class="text-red-700 ml-2 font-semibold font-arabic font-base flex items-center gap-1"
              *ngIf="weight?.invalid && weight?.dirty"
            >
              <img
                src="./icons/si_warning-fill.svg"
                alt=""
                class="w-4 h-4 mt-[1px]"
              />
              <div>
                <small *ngIf="weight?.errors?.['required']">
                  ูุฌุจ ุฅุฏุฎุงู ูุฒู ุงูุทูู.
                </small>
                <small *ngIf="weight?.errors?.['pattern']">
                  ูุฌุจ ุฃู ูููู ูุฒู ุงูุทูู ุฃูุซุฑ ูู 1 ูุฌู.
                </small>
              </div>
            </div>
          </div>
          <div>
            <label
              class="block text-xl font-semibold mb-2 mr-2"
              for="medical-history"
            >
              ุงูุชุงุฑูุฎ ุงููุฑุถู

              <span class="text-third-txt text-base"> (ุฅุฎุชูุงุฑู)</span>
            </label>
            <div class="relative">
              <input
                formControlName="medicalHistory"
                type="text"
                name="medical-history"
                id="medical-history"
                placeholder="ุงูุชุงุฑูุฎ ุงููุฑุถู"
                class="placeholder:text-right w-full py-3 px-10 border rounded-lg outline-none border-third-border placeholder:text-third-txt placeholder:text-base"
              />
              <img
                class="absolute right-4 top-1/2 -translate-y-[calc(50%+1px)] text-sm w-[18px] h-[18px]"
                src="icons/material-symbols_history.svg"
                alt=""
              />
            </div>
          </div>
          <div
            class="px-4 py-3 flex gap-2 w-full text-lg font-normal font-arabic text-third-txt"
          >
            <p>ูู ุชุฑูุฏ ุฅุถุงูุฉ ุตูุฑ ุชุญุงููู ุฃู ุฅุดุงุนุงุช</p>

            <div class="flex">
              <label
                for="medical-images"
                class="font-semibold text-[#121212] underline cursor-pointer"
                >ุฅุถุงูุฉ ุตูุฑ</label
              >
              <input
                type="file"
                id="medical-images"
                name="medical-images"
                (change)="getImagePath($event)"
                class="shadow-none hidden"
                multiple
              />
            </div>
          </div>
          <ul
            class="flex flex-col px-4 gap-2 w-full text-sm font-normal font-arabic text-third-txt"
          >
            <li
              *ngFor="let file of medicalImagesFromApi; let i = index"
              class="flex items-center gap-2"
            >
              <ng-container [ngSwitch]="file.type">
                <!-- ุฅุฐุง ูุงูุช ุตูุฑุฉ -->
                <img
                  *ngSwitchCase="'image'"
                  [src]="file.preview"
                  alt="ุตูุฑุฉ"
                  class="w-20 h-20 object-cover rounded-md"
                />
                <div *ngSwitchCase="'file'" class="flex items-center gap-2">
                  <span class="text-xl">๐</span>
                  <span class="truncate w-40">{{ file.name }}</span>
                </div>
              </ng-container>

              <button
                type="button"
                (click)="removeImage(i)"
                class="text-red-500 hover:text-red-700"
                title="ุญุฐู ุงูููู"
              >
                โ
              </button>
            </li>
          </ul>

          <div class="flex justify-between items-center mt-5">
            <button
              (click)="goBack()"
              class="flex w-fit items-center justify-center gap-2 bg-[#151419] text-mainBg-100 px-6 py-[9px] rounded-lg transition duration-200 hover:opacity-80"
            >
              <img
                src="/icons/streamline_emergency-exit.svg"
                alt=""
                class="w-6 h-6"
              />
              <span class="text-base font-semibold">ุฑุฌูุน</span>
            </button>

            <button
              *ngIf="formEditProfile.valid && formEditProfile.dirty"
              class="cursor-pointer text-lg flex font-arabic gap-[10px] py-[9px] px-[24px] rounded-lg font-bold bg-primary-btn text-mainBg-100 transition duration-200 hover:bg-[#0B4632]"
            >
              ุญูุธ ุงูุชุบููุฑุงุช
            </button>
          </div>
          <!-- @if (msgError) {
          <p class="alert alert-danger w-50 m-0">{{ msgError }}</p>
          } -->
        </form>
      </div>
    </div>
  </div>
</section>
